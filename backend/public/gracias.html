
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obrigado! üáßüá∑</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="stylegracias.css">
</head>

<body>
    <!-- Fondo con elementos brasile√±os -->
    <div class="brasil-bg">
        <div class="brasil-element element-1">üå¥</div>
        <div class="brasil-element element-2">‚öΩ</div>
        <div class="brasil-element element-3">üíÉ</div>
        <div class="brasil-element element-4">üéµ</div>
    </div>

    <!-- Part√≠culas decorativas -->
    <div class="particles" id="particles"></div>

    <!-- Confeti -->
    <canvas id="confetti"></canvas>

    <div class="content">
        <div class="title-container">
            <div class="flag-decoration">
                <div class="flag-circle circle-verde"></div>
                <div class="flag-circle circle-amarillo"></div>
                <div class="flag-circle circle-azul"></div>
            </div>
            <h1>¬°Obrigado! üáßüá∑</h1>
        </div>

        <div class="message">
            üå∏ ¬°Tu visita llen√≥ de magia nuestro stand! üå∏<br><br>
            Gracias por acercarte, re√≠r, curiosear y compartir con nosotros este
            espacio lleno de color, ideas y buena vibra ‚ú®<br><br>
            Nos alegra que hayas sido parte de esta feria tan especial üíï
        </div>

        <!-- Secci√≥n de c√≥digos QR -->
        <div class="qr-section">
            <div class="qr-title">üì± Comparte nuestra experiencia</div>
            <div class="qr-container">
                <div class="qr-item">
                    <div id="qr-encuesta" class="qr-code">
                        <div class="qr-placeholder">Cargando QR...</div>
                    </div>
                    <div class="qr-label">Encuesta Brasil</div>
                </div>
                <div class="qr-item">
                    <div id="qr-agradecimiento" class="qr-code">
                        <div class="qr-placeholder">Cargando QR...</div>
                    </div>
                    <div class="qr-label">P√°gina de Agradecimiento</div>
                </div>
            </div>
        </div>

        <div class="social-tag">
            üì∏ No olvides etiquetarnos y compartir tu momento con<br>
            <span class="hashtag">#Fonoferiabrasil</span> üáßüá∑
        </div>

        <div class="btn-container">
            <button class="btn" onclick="window.location.href='index.html'">
                üé™ Volver al Stand
            </button>
            <button class="btn btn-secondary" onclick="compartirConQR()">
                üì± Compartir con QR
            </button>
            <button class="btn btn-secondary" onclick="descargarQRs()">
                ‚¨áÔ∏è Descargar QRs
            </button>
        </div>
    </div>

    <!-- Cargar QRCode desde CDN m√°s confiable -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>

    <script>
        // URLs para los QR
        const urlEncuesta = window.location.origin + '/index.html';
        const urlAgradecimiento = window.location.href;

        // Funci√≥n para verificar si la biblioteca QR est√° cargada
        function verificarQRCode() {
            if (typeof qrcode === 'undefined') {
                console.error('QRCode library not loaded');
                return false;
            }
            return true;
        }

        // Generar c√≥digos QR usando la librer√≠a qrcode-generator
        function generarQRs() {
            if (!verificarQRCode()) {
                console.log('Intentando cargar QRCode...');
                setTimeout(generarQRs, 500);
                return;
            }

            try {
                console.log('Generando QRs con librer√≠a:', typeof qrcode);

                // QR para la encuesta
                const qrEncuesta = document.getElementById('qr-encuesta');
                if (qrEncuesta) {
                    qrEncuesta.innerHTML = '';
                    generarQRConCanvas(qrEncuesta, urlEncuesta, '#002776');
                }

                // QR para la p√°gina de agradecimiento
                const qrAgradecimiento = document.getElementById('qr-agradecimiento');
                if (qrAgradecimiento) {
                    qrAgradecimiento.innerHTML = '';
                    generarQRConCanvas(qrAgradecimiento, urlAgradecimiento, '#009739');
                }

            } catch (error) {
                console.error('Error en generarQRs:', error);
                // Fallback: mostrar enlaces como texto
                mostrarEnlacesComoTexto();
            }
        }

    function generarQRConCanvas(container, text, color) {
        try {
            const typeNumber = 0; // Auto
            const errorCorrectionLevel = 'L';
            const qr = qrcode(typeNumber, errorCorrectionLevel);
            qr.addData(text);
            qr.make();

            const canvas = document.createElement('canvas');
            const size = 130; // Tama√±o fijo para que quepa en el contenedor
            const cellSize = size / qr.getModuleCount();
            const margin = 0;

            canvas.width = size;
            canvas.height = size;
            canvas.style.maxWidth = '100%';
            canvas.style.height = 'auto';

            const ctx = canvas.getContext('2d');

            // Fondo blanco
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Dibujar QR
            ctx.fillStyle = color;
            for (let row = 0; row < qr.getModuleCount(); row++) {
                for (let col = 0; col < qr.getModuleCount(); col++) {
                    if (qr.isDark(row, col)) {
                        ctx.fillRect(
                            margin + col * cellSize,
                            margin + row * cellSize,
                            cellSize,
                            cellSize
                        );
                    }
                }
            }

            container.appendChild(canvas);

        } catch (error) {
            console.error('Error generando QR con canvas:', error);
            mostrarErrorQR(container);
        }
    }

        // Fallback: mostrar enlaces como texto si falla la generaci√≥n de QR
        function mostrarEnlacesComoTexto() {
            const qrEncuesta = document.getElementById('qr-encuesta');
            const qrAgradecimiento = document.getElementById('qr-agradecimiento');

            if (qrEncuesta) {
                qrEncuesta.innerHTML = `
                    <div style="text-align: center; padding: 10px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Encuesta:</div>
                        <a href="${urlEncuesta}" style="font-size: 10px; word-break: break-all; color: #002776;">
                            ${urlEncuesta}
                        </a>
                    </div>
                `;
            }

            if (qrAgradecimiento) {
                qrAgradecimiento.innerHTML = `
                    <div style="text-align: center; padding: 10px;">
                        <div style="font-size: 12px; color: #666; margin-bottom: 5px;">Agradecimiento:</div>
                        <a href="${urlAgradecimiento}" style="font-size: 10px; word-break: break-all; color: #009739;">
                            ${urlAgradecimiento}
                        </a>
                    </div>
                `;
            }
        }

        // Mostrar error si falla la generaci√≥n de QR
        function mostrarErrorQR(element) {
            if (element && typeof element.innerHTML !== 'undefined') {
                element.innerHTML = `
                    <div style="color: #666; font-size: 12px; text-align: center; padding: 20px;">
                        ‚ùå Error cargando QR<br>
                        <a href="javascript:generarQRs()" style="color: #002776; font-size: 10px;">
                            Reintentar
                        </a>
                    </div>
                `;
            }
        }

        // Descargar QR individual
        function descargarQR(url, nombre) {
            if (!verificarQRCode()) {
                alert('La funci√≥n de QR no est√° disponible. Intenta recargar la p√°gina.');
                return;
            }

            try {
                const typeNumber = 0;
                const errorCorrectionLevel = 'L';
                const qr = qrcode(typeNumber, errorCorrectionLevel);
                qr.addData(url);
                qr.make();

                const canvas = document.createElement('canvas');
                const size = 300;
                const cellSize = size / qr.getModuleCount();

                canvas.width = size;
                canvas.height = size;

                const ctx = canvas.getContext('2d');

                // Fondo blanco
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Dibujar QR
                ctx.fillStyle = '#002776';
                for (let row = 0; row < qr.getModuleCount(); row++) {
                    for (let col = 0; col < qr.getModuleCount(); col++) {
                        if (qr.isDark(row, col)) {
                            ctx.fillRect(
                                col * cellSize,
                                row * cellSize,
                                cellSize,
                                cellSize
                            );
                        }
                    }
                }

                const link = document.createElement('a');
                link.download = `QR_${nombre}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();

            } catch (error) {
                console.error('Error descargando QR:', error);
                alert('Error al descargar el QR. Intenta nuevamente.');
            }
        }

        // Descargar ambos QRs
        function descargarQRs() {
            if (!verificarQRCode()) {
                alert('La funci√≥n de QR no est√° disponible. Intenta recargar la p√°gina.');
                return;
            }

            descargarQR(urlEncuesta, 'Encuesta_Brasil');
            setTimeout(() => {
                descargarQR(urlAgradecimiento, 'Agradecimiento_Brasil');
            }, 500);
        }

        // Compartir con QR
        function compartirConQR() {
            const mensaje = `¬°Visita nuestro Stand de Brasil! üáßüá∑\n\n` +
                `üìù Encuesta: ${urlEncuesta}\n` +
                `üôè Agradecimiento: ${urlAgradecimiento}\n\n` +
                `#Fonoferiabrasil`;

            if (navigator.share) {
                navigator.share({
                    title: 'Stand Brasil - Fonoferia',
                    text: mensaje,
                    url: urlEncuesta
                });
            } else {
                navigator.clipboard.writeText(mensaje).then(() => {
                    alert('‚úÖ Enlaces copiados al portapapeles. ¬°Comp√°rtelos con tus amigos!');
                }).catch(() => {
                    const textArea = document.createElement('textarea');
                    textArea.value = mensaje;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    alert('‚úÖ Enlaces copiados al portapapeles. ¬°Comp√°rtelos con tus amigos!');
                });
            }
        }

        // üåà Animaci√≥n de confeti mejorada
        function iniciarConfeti() {
            const canvas = document.getElementById('confetti');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const confettiCount = 200;
            const confetti = [];
            const colors = ['#009739', '#FEDF00', '#002776', '#FFFFFF', '#FF6B6B'];

            for (let i = 0; i < confettiCount; i++) {
                confetti.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    r: Math.random() * 8 + 3,
                    d: Math.random() * confettiCount,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.floor(Math.random() * 10) - 10,
                    tiltAngle: 0,
                    tiltAngleIncrement: Math.random() * 0.1 + 0.05
                });
            }

            function drawConfetti() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                confetti.forEach(p => {
                    ctx.save();
                    ctx.translate(p.x + p.tilt, p.y);
                    ctx.rotate(p.tiltAngle);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.r / 2, -p.r / 2, p.r, p.r);
                    ctx.restore();
                });
                updateConfetti();
            }

            function updateConfetti() {
                confetti.forEach(p => {
                    p.tiltAngle += p.tiltAngleIncrement;
                    p.y += (Math.cos(p.d) + 1 + p.r / 2) * 0.5;
                    p.x += Math.sin(p.d) * 2;
                    p.tilt = Math.sin(p.tiltAngle) * 15;

                    if (p.y > canvas.height) {
                        p.x = Math.random() * canvas.width;
                        p.y = -20;
                        p.r = Math.random() * 8 + 3;
                    }
                });
            }

            function animate() {
                drawConfetti();
                requestAnimationFrame(animate);
            }
            animate();
        }

        // Crear part√≠culas brasile√±as
        function crearParticulas() {
            const particlesContainer = document.getElementById('particles');
            if (!particlesContainer) return;

            const colors = ['#009739', '#FEDF00', '#002776'];

            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (Math.random() * 5 + 5) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Inicializar todo cuando la p√°gina cargue
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM cargado, inicializando efectos...');
            crearParticulas();
            iniciarConfeti();

            // Esperar a que cargue la librer√≠a QR
            setTimeout(() => {
                generarQRs();
            }, 1000);
        });

        // Ajustar canvas al redimensionar
        window.addEventListener('resize', function () {
            const canvas = document.getElementById('confetti');
            if (canvas) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
        });
    </script>
</body>

</html>
